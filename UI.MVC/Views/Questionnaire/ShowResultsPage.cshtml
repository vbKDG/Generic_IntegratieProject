@using Domain
@model QuestionResultModel

<h1>Questionnaire results</h1>
<h3>Questionnaire: @Model.questionnaire.Name</h3>
<p>The questionnaire has been answered @Model.answeredQuestionAmount time(s).</p>

<table class="table">
    @if (Model.questions == null)
    {
        <p>Unfortunately there is no data collected for this questionnaire yet.</p>
    }
    else
    {
        for (var i = 0; i < Model.questions.Count(); i++)
        {
            <tr>
                <td>
                    <h4>@Model.questions.ToList()[i].TheQuestion</h4>
                    @foreach (var o in @Model.questions.ToList()[i].Options)
                    {
                        @o.TheOption
                        foreach (var aqa in @Model.optionsAmounts)
                        {
                            if (aqa.optionId == o.OptionId)
                            {
                                if (o.Question.QuestionType == QuestionType.CHECK_BOX)
                                {
                                    <span> (@aqa.count)</span>
                                }
                                else
                                {
                                    double percentage = Convert.ToDouble(aqa.count) / Convert.ToDouble(@Model.answeredQuestionAmount) * 100;
                                    <span> (@aqa.count) @percentage.ToString("0.00")%</span>
                                }
                            }
                        }
                        <br>
                    }
                </td>
            </tr>
        }
    }
</table>