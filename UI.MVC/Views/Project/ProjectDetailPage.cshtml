@model ProjectDetailModel

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="~/js/phaseLine.js" asp-append-version="true"></script>
<link rel="stylesheet" href="~/css/phaseLine.css">

<body onload="loadPage('@Model.Project.Setting.BackGroundColor1', '@Model.Project.Setting.BackGroundColor2', '@Model.Project.Setting.FontFamily')">
<div id="fontFamily">
    <h2>Project: @Model.Project.name</h2>
    <h4>Description of the project</h4>
    <p>@Model.Project.description</p>
    @if (@Model.Project.imageField != null)
    {
        <img src=@Model.Project.imageField.GetImageString() width="500"/>
    }
    @if (@Model.Project.phases.Count > 0)
    {
        <h4>Phases of the project</h4>
        <div class="phaseContainer">
            <ul class="progressbar">
                @for (int i = 0; i < @Model.Project.phases.Count(); i++)
                {
                    if (i == 0)
                    {
                        if (@DateTime.Now > @Model.Project.phases.ToList()[i].startDate)
                        {
                            <li class="active popper" data-toggle="popover">
                                @Model.Project.phases.ToList()[i].name<br>@Model.Project.startDate</li>
                        }
                        else
                        {
                            <li class="popper" data-toggle="popover">
                                @Model.Project.phases.ToList()[i].name<br>@Model.Project.startDate</li>
                        }
                    }
                    else if (i == @Model.Project.phases.Count() - 1)
                    {
                        if (@DateTime.Now > @Model.Project.phases.ToList()[i].startDate)
                        {
                            <li id="phase-@i" class="active popper" data-toggle="popover">
                                @Model.Project.phases.ToList()[i].name<br>@Model.Project.endDate</li>
                        }
                        else
                        {
                            <li id="phase-@i" class="popper" data-toggle="popover">
                                @Model.Project.phases.ToList()[i].name<br>@Model.Project.endDate</li>
                        }
                    }
                    else
                    {
                        if (@DateTime.Now > @Model.Project.phases.ToList()[i].startDate)
                        {
                            <li class="active popper" data-toggle="popover">@Model.Project.phases.ToList()[i].name</li>
                        }
                        else
                        {
                            <li class="popper" data-toggle="popover">@Model.Project.phases.ToList()[i].name</li>
                        }
                    }
                    <div class="popper-content hide">
                        <h4>@Model.Project.phases.ToList()[i].name</h4>
                        <p>
                            From @Model.Project.phases.ToList()[i].startDate <br>
                            Till @Model.Project.phases.ToList()[i].endDate</p>
                        <p>@Model.Project.phases.ToList()[i].description</p>
                    </div>
                }
            </ul>
        </div>
    }

    @if (@Model.Project.ideations.Count > 0)
    {
        <table class="table">
            <h4>Top 5 most popular ideations</h4>
            @foreach (var ideation in @Model.Project.ideations)
            {
                foreach (var countLikes in Model.LikeAmounts)
                {
                    if (countLikes.Key == ideation.ideationId)
                    {
                        <tr>
                            <td>
                                <span>Ideation -</span>
                                @countLikes.Value
                                <i class="glyphicon glyphicon-thumbs-up"></i>
                                @foreach (var countComments in Model.CommentAmounts)
                                {
                                    if (countComments.Key == ideation.ideationId)
                                    {
                                        @countComments.Value
                                        <i class="glyphicon glyphicon-comment"></i>
                                    }
                                }
                            </td>
                            <td>
                                @Html.ActionLink("Show ideas", "Ideas", "Idea"
                                    , new {ideationId = ideation.ideationId})
                            </td>
                        </tr>
                    }
                }
            }
        </table>
        @Html.ActionLink("Show all ideations", "Project", "Project"
            , new {id = Model.Project.projectId})
    }

    @if (Model.Project.questionnaires.Count > 0)
    {
        <h4>All questionnaires</h4>
        <table class="table">
            <tr>
                <th>
                    <p>Questionnaire name</p>
                </th>
                <th>
                    <p>Amount of questions</p>
                </th>
            </tr>
            @foreach (var questionnaire in @Model.Project.questionnaires)
            {
                <tr>
                    <td>
                        @questionnaire.Name
                    </td>
                    <td>
                        @questionnaire.QuestionAmount
                    </td>
                    <td>
                        @Html.ActionLink("Complete Questionnaire", "Questionnaire", "Questionnaire"
                            , new {questionnaireId = questionnaire.QuestionnaireId})
                    </td>
                </tr>
            }
        </table>
        @Html.ActionLink("Show all questionnaires", "Questionnaires", "Questionnaire"
            , new {projectId = Model.Project.projectId})
    }

    @if (@Model.IdeationQuestions.Count > 0)
    {
        <h3>Central questions (@Model.IdeationQuestions.Count)</h3>
        <div id="myCarousel" class="carousel slide text-center" data-ride="carousel">
            <div class="carousel-inner" role="listbox">
                @for (var i = 0; i < @Model.IdeationQuestions.Count; i++)
                {
                    if (i == 0)
                    {
                        <div class="item active">
                            <p>@Model.IdeationQuestions.ToList()[i].question</p>
                            <p>@Model.IdeationQuestions.ToList()[i].description</p>
                            <a href="http://@Model.IdeationQuestions.ToList()[i].backgroundInfo">More background info</a>
                        </div>
                    }
                    else
                    {
                        <div class="item">
                            <p>@Model.IdeationQuestions.ToList()[i].question</p>
                            <p>@Model.IdeationQuestions.ToList()[i].description</p>
                            <a href="http://@Model.IdeationQuestions.ToList()[i].backgroundInfo">More background info</a>
                        </div>
                    }
                }
            </div>

            <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    }
</div>

</body>